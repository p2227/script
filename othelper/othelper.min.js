void(function(t){try{t()}catch(t){alert('当前浏览器不支持，建议升级到最新版本chrome')}})(function(){let t=localStorage.getItem('__DEV__')==='1',e=500,a=11,n='otData',i={'getOtData':'W03030200','fillOtData':'zzcOT'},r={'fillOtData':'/Workflow/form/New-zzcOT'},l='tbStaffDaily',g={'fnOT1':'fnOT1','fnOT2':'fnOT2','fnOT3':'fnOT3','OTSwitchHours':t?'fnOT3':'OTSwitchHours','GetRangeStartDate':'GetRangeStartDate','GetRangeEndDate':'GetRangeEndDate','DateFormat':'DateFormat'},c={'prev':'[data-handler="prev"]','SwitchType':'[data-bind*="SwitchType"]'};function o(t){return new Promise((e,a)=>{setTimeout(e,t)})}function d(t){return`td[data-bind*="${g[t]||t}"]`}function f(t){var e=$(`#${l} ${d(t)}:not(:empty)`),a=[];e.each((t,e)=>{var n=$(e);n.siblings(d('OTSwitchHours')).html()==''&&a.push(n)});return a}function s(t){if(t.length>a){alert(`你太勤奋了，加班已经达到${t.length}次，但是我们试过，一次性提交太多会失败，建议一次提交${a}个，等这次审批完之后再提交`);return t.slice(0,11)}return t}function D(){var t=f('fnOT1'),e=$(`#${l} ${d('GetRangeEndDate')}`),a=[];e.each((t,e)=>{var n=$(e);n.text()==='21:30'&&n.siblings(d('fnOT1')).text()===''&&n.siblings(d('GetShiftName')).text()==='正常行政班'&&n.siblings(d('OTSwitchHours')).html()==''&&a.push(n.siblings(d('fnOT1')))});return t.concat(a)}function O(){var e=D(),a=f('fnOT2');a=a.concat(f('fnOT3'));var i=e.map(t=>{return{DateFormat:t.siblings(d('DateFormat')).text().match(/\d{4}-\d{2}-\d{2}/)[0],GetRangeStartDate:'21:00',GetRangeEndDate:t.siblings(d('GetRangeEndDate')).text(),type:'fnOT1'}});a.map(t=>{return{DateFormat:t.siblings(d('DateFormat')).text().match(/\d{4}-\d{2}-\d{2}/)[0],GetRangeStartDate:t.siblings(d('GetRangeStartDate')).text(),GetRangeEndDate:t.siblings(d('GetRangeEndDate')).text(),type:'fnOT2'}});var l=i;l=s(l);l.length>0?(localStorage.setItem(n,JSON.stringify(l)),alert('已成功获取加班数据'),t||location.assign(r.fillOtData)):(alert("没检测到你的加班信息，是不是要查询上一个月加班？"),$('#dvStartDate,#dvEndDate').css({'border-color':'red'}))}async function T(){t&&($('[data-bind*="$root.Delete"]:gt(0)').click(), await o(e));var a=localStorage.getItem(n);console.log(a);a=JSON.parse(a);async function i(t,n){var i=new Date(t.DateFormat);$(`#Date${n}`).val(t.DateFormat).trigger('blur').trigger('click');await o(e);var r=`td[data-year=${i.getFullYear()}][data-month=${i.getMonth()}]:contains(${i.getDate()})`;let l=$('.ui-datepicker-calendar').find(r);l.length===0&&($(c.prev).click(),l=$('.ui-datepicker-calendar').find(r));l.each(function(){var t=$(this);t.text()===''+i.getDate()&&(t.find('a').trigger('click'),console.log(t))});await o(e);$(`#dvStart${n}display`).val(t.GetRangeStartDate).trigger('blur');await o(e);$(`#dvEnd${n}display`).val(t.GetRangeEndDate).trigger('blur');await o(e);$("select.form-controlText[data-bind*=OTMealMinutes]").val(0).trigger('change');await o(e);let g=+t.GetRangeEndDate.slice(0,2);t.type==='fnOT1'&&g<21&&($(`#dvEnd${n}display`).siblings('.k-dropdown').click(),await o(0),$(`.k-animation-container #dvEnd${n}popup_listbox`).last().find('li:eq(1)').click(),await o(e));n===a.length-1?($('input[data-bind*=Remark]').val('项目加班').trigger('change'),$('a[data-bind*="$root.Add"]').click(),await o(e),$('[data-bind*="$root.Delete"]:last').click()):$('a[data-bind*="$root.Add"]').click();await o(e)}for(let t=0;t<a.length;t++)i(a[t],t),await o(e*6);$('#loadingDiv').hide();t||localStorage.clear(n);await o(e);alert('请检查后提交加班申请');$('#hlp-tips').length===0&&$('.navbar.navbar-fixed-top').append("<span id=\"hlp-tips\" style=\"color:red\">周末加班要不要填写，是调休还是加班费，请联系您的主管确认</span>");$(c.SwitchType).css('border-color','red').removeAttr('disabled','')}var{href:h}=location;h.indexOf(i.getOtData)>0?O():T()})